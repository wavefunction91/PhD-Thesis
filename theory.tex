\chapter{Theoretical Basis}
\label{ch:Theory}

In this chapter, I will outline the theoretical preliminaries which will serve as the basis
for the subsequent development of relativistic electronic structure theory. Further, this
chapter will serve as the primary source of notation which will be used throughout the
remainder of this work. 

% Quantum Mechanics
\section{Quantum Mechanical Preliminaries}
\label{sec:QM}

\subsection{The Physical Hilbert Space and The Slater Determinant}
\label{sec:SD}

Perhaps the most fundamental axiom of quantum mechanics is in that for every physical
system, there is associated a separable complex Hilbert space, $\hilb{H}$, such that
the vectors of said Hilbert space represent the quantum states 
of the system \cite{VonNeumann55_book}. Such vectors are referred to as wave functions
and the inner product on $\hilb{H}$ is referred to as an expectation value.
The formal structure of $\hilb{H}$ is dictated by the Hamiltonian
for the physical system, $\op{H} : \hilb{H} \rightarrow \hilb{H}$, through the wave equation
\begin{equation}
  \label{eq:QWave}
\op{H}(t) \ket{\Psi(t)} = \ii \partial_t \ket{\Psi(t)}, 
  \qquad \ket{\Psi(t)} \in \hilb H.
\end{equation}
Here, $t$ is the proper time of the quantum system and $\partial_t$ is the partial derivative
of the wave function with respect to time.
The nature of $\op H$ for various physical situations and approximations relevant
to this work will be discussed in detail in later sections 
(see \cref{sec:NRH,sec:RELH} for instance), however the mere existence of such
an operator at this stage is sufficient for the subsequent developments.
As the primary focus of this work will be the treatment of the many--body electronic
problem in molecular quantum mechanics, one might remark that the physical system
in question is a \emph{composite} system consisting of many, indistinguishable 
particles (electrons). Denoting the Hilbert space of a composite system consisting
of $N$ particles as $\hilb{H}^N$, we know that as $\hilb{H}^N$ is separable,
it must admit a countable, dense basis \cite{Lee03_book}.
The direct product space consisting of the Hilbert spaces
which describe its constituent parts, namely those spaces which describe a
single particle system: $\hilb{H}^1$, provides a convenient basis for $\hilb{H}^N$ such that
\begin{equation}
  \label{eq:SepHilbert}
  \hilb{H}^N = \Span{\bigotimes_{i = 1}^N \hilb{H}^1}.
\end{equation}
The separability condition of \cref{eq:SepHilbert} is crucial to the following developments
as it allows one to construct a simple basis for vectors in $\hilb{H}^N$
as $N$--fold tensor products of single--particle wave functions which form a countable basis for $\hilb{H}^1$, 
i.e. $\hilb{C} = \set{\ket{\phi_p}}  \subset \hilb{H}^1$ such that 
$\hilb{H}^1 = \Span{\hilb{C}}$. In the following, vectors in $\hilb{H}^1$, in particular elements of $\hilb{C}$,
will be referred to as orbitals.

As the electron is the moiety of interest in this work, vectors in $\hilb{H}^N$ must adhere to certain additional 
criteria in order for them to represent physically realizable wave functions. In the case of electrons, which are 
fermions, physically relevant elements of $\hilb{H}^N$, which we will denote $\hilb{H}^N_- \subset \hilb{H}^N$, must 
adhere to Fermi--Dirac statistics, namely that they must exhibit anti-symmetric behavior under particle permutation
\cite{Walecka12_book,Schuck04_book}, i.e.
\begin{equation}
  \label{eq:FermiDirac}
  \hilb{P}_{ij} \ket{\Phi^N} = -\ket{\Phi^N}, \qquad \ket{\Phi^N} \in \hilb{H}^N_-,
\end{equation} 
where $\hilb{P}_{ij}$ is the particle permutation operator which interchanges particle $i$ and $j$ 
(for a more thorough discussion on linear operators acting on $\hilb{H}^N$, see \cref{sec:LO}). Remark
that this notion of particle interchange is intimately related to \cref{eq:SepHilbert}. With this additional
constraint, we may construct a basis for $\hilb{H}^N_-$ with elements
\begin{equation}
  \label{eq:SlaterDet}
  \ket{\Phi^N_I} = \frac{1}{\sqrt{N!}} \sum_{\xi \in S_N(\hilb{K}^N_I)} \Sign{\xi} \text{ } \bigotimes_{i = 1 }^N \ket{\phi_{\xi(i)}},
\end{equation}
where $\hilb{K}_I^N$ is an $N$--element subset of $\hilb{C}$ and $S_N(\hilb{K}_I^N)$ is the symmetric group
of $\hilb{K}_I^N$ which consists of all permutations of its elements, which are denoted here as permutation
functions $\xi$. $\Sign{\xi} \in \{ \pm 1 \}$ denotes the sign of the permutation and ensures the anti--symmetry of
the overall wave function. \Cref{eq:SlaterDet} introduces a number of concepts with are typically jargonized 
in the quantum chemistry community. In this work, $\hilb{K}_I^N$ will be referred to as an $N$--particle
configuration (or simply a configuration when $N$ is to be understood from the context), and $\ket{\Phi^N_I}$
will be referred to as a Slater determinant. It is important to note that $\ket{\Phi^N_I}$ is completely 
determined by $\hilb{K}_I^N$. The $N$--fold tensor product on the right hand side of \cref{eq:SlaterDet}
if referred to as a Hartree product, and while not a valid fermionic wave function in and of itself,
it provides an important building block for constructing such wave functions and will be the primary
moiety with which we will develop the arithmetic of many body quantum theory. As such, we reserve a shorthand
for the Hartree product constructed for a general set $\set{\ket{\psi_p}}\subset\hilb{H}^1$ as
$ \ket{\psi_1,\psi_2\cdots} \equiv \ket{\psi_1} \otimes \ket{\psi_2} \otimes \cdots$.

As a basis for $\hilb{H}^N_-$, any vector $\ket{\Psi^N} \in \hilb{H}^N_-$ may be written as \cite{Ostlund12_book}
\begin{equation}
\ket{\Psi^N} = \sum_I D_I \ket{\Phi^N_I},
\end{equation}
where $D_I\in\mathbb C$ is the complex expansion coefficient of the $I$-th configuration in the overall wave function,
and $I$ runs over all possible $N$--particle Slater determinants which may be constructed from $\hilb{C}$.
The fact that the set of all Slater determinants forms a basis for $\hilb{H}^N_-$
serves as the primary foundation for the majority of approximate quantum mechanical methods regarding molecular
systems. In the following, we will assume both $\ket{\Phi^N_I}$ and the elements of $\hilb{C}$ are orthonormal
with respect to the metric on their respective Hilbert spaces.

While the Hilbert space representation of the wave function is the most illuminating description for the development of
general quantum mechanical theory, it is often advantageous from the perspective of practical calculations that one
projects the vectors of the Hilbert space onto a convenient basis. 
To this end, we consider a specific single particle spinor basis, $\set{\ket{\vc{r},\sigma} = \ket{\vc{r}}\otimes\ket{\sigma}}$, 
which consists of the simultaneous eigenfunctions
of both the position and $z$--spin operators, denoted $\op{\vc{r}}$ and $\op{S}_z$ respectively,
such that
\begin{subequations}
\begin{align}
  \op{\vc{r}}\ket{\vc{r},\sigma} &= \ket{\vc{r},\sigma}\vc{r}, \qquad \vc{r}\in\mathbb{R}^3, \\
  \op{S}_z\ket{\vc{r},\sigma}    &= \ket{\vc{r},\sigma}\sigma, \qquad \sigma \in \set{\pm\frac{1}{2}}.
\end{align}
\end{subequations}
Here, we have denoted the particle's position and $z$--axis spin projection as $\vc{r}$ and $\sigma$, respectively.
Namely, if $\hilb{H}^1$ represents a spin--1/2 fermion, $\set{\ket{\vc{r},\sigma}}$ forms a complete basis for $\hilb{H}^1$ 
and admits the following orthonormality  condition on the $\hilb{H}^1$ inner product,
\begin{equation}
  \label{eq:SpinorInner}
  \inner{\vc{r}',\sigma'}{\vc{r},\sigma} = \delta^3(\vc{r} - \vc{r}')\delta_{\sigma\sigma'},
\end{equation}
where $\delta^3$ and $\delta_{\sigma\sigma'}$ are the Dirac delta function and Kronecker delta tensor, respectively.
As $\set{\ket{\vc{r},\sigma}}$ is continuous, i.e. its spectrum is continuous, its cardinality is uncountable. Thus,
its utility does not manifest as it does in the context of countable bases, such as is required by \cref{eq:SlaterDet},
but rather in the fact that it allows for the casting of inner products on $\hilb{H}^1$ as integrals through the resolution
of the identity on $\hilb{H}^1$ via
\begin{equation}
  \label{eq:H1Identity}
  \op{1}_1 = \sum_\sigma \int_{\mathbb R ^3} \ket{\vc{r},\sigma}\bra{\vc{r},\sigma} \dd^3\vc{r}.
\end{equation}
As such, for arbitrary $\ket{\phi},\ket{\phi'}\in\hilb{H}^1$ we may cast the inner product as
\begin{equation}
\inner{\phi}{\phi'} = \sum_\sigma \int_{\mathbb R ^3} \phi^*(\vc{r},\sigma) \phi'(\vc{r},\sigma) \dd^3\vc{r},
\end{equation}
where we have defined
\begin{equation}
  \label{eq:SpinorOrbital}
  \inner{\vc{r},\sigma}{\phi} \equiv \phi(\vc{r},\sigma), \quad \mathrm{s.t.} \quad \phi : \mathbb F \mapsto \mathbb C,
\end{equation}
and $\mathbb F = \mathbb R^3 \times \set{\pm1/2}$. 
\Cref{eq:SpinorOrbital}, as a projection onto
an element of a product space, may be further separated onto the spin basis, $\set{\alpha,\beta}$,
\begin{align}
  \phi(\vc{r},\sigma) = \phi^\alpha(\vc{r})\alpha(\sigma) + \phi^\beta(\vc{r})\beta(\sigma),
\end{align}
such that
\begin{align}
  &\alpha(\sigma) = \begin{cases} 1 & \sigma = +\frac{1}{2} \\ 0 & \sigma = -\frac{1}{2} \end{cases}, \\ 
  &\beta(\sigma)  = \begin{cases} 0 & \sigma = +\frac{1}{2} \\ 1 & \sigma = -\frac{1}{2} \end{cases}.
\end{align}
In general, single particle wave functions of the form \cref{eq:SpinorOrbital} will be referred to as spinor orbitals, or simply spinors.
For brevity in the following, we will denote $\ket{\vc{x}} \equiv \ket{\vc{r},\sigma}$ such that
\begin{subequations}
\begin{align}
\int_{\mathbb F} f(\vc{x}) \dd^4 \vc{x} &\equiv \sum_\sigma \int_{\mathrm{R}^3} f(\vc{r},\sigma) \dd^3 \vc{r},\\
\delta^4(\vc{x} - \vc{x}') &\equiv \delta^3(\vc{r} - \vc{r}')\delta_{\sigma\sigma'}
\end{align}
\end{subequations}

As a basis for $\hilb{H}^1$, we may construct a basis for $\hilb{H}^N$ through $N$--fold tensor products 
of the elements of $\set{\ket{\vc{x}}}$ via \cref{eq:SepHilbert}. Denoting $\ket{\vc{x}_i}$ as
a specific element of $\set{\ket{\vc{x}}}$, the vectors
\begin{equation}
  \label{eq:MBSpinorBasis}
  \ket{\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N} = \bigotimes_{i = 1}^N \ket{\vc{x}_i}
\end{equation}
form a basis form a basis for $\hilb{H}^N$. Extending \cref{eq:SpinorInner,eq:H1Identity} in a similar manner, we may state
\begin{equation}
  \inner{\vc{x}'_1,\vc{x}'_2,\ldots,\vc{x}'_N}{\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N} = \prod_{i=1}^N \delta^3(\vc{r}'_i - \vc{r}_i)\delta_{\sigma_i\sigma'_i},
\end{equation}
\begin{equation}
  \op{1}_N = \idotsint_{\mathbb F} \bigotimes_{i=1}^N \ket{\vc{x}_i} \bra{\vc{x}_i} \dd^4\vc{x}_i,
\end{equation}
such that for $\ket{\Phi^N},\ket{\Psi^N} \in \hilb{H}^N$,
\begin{align}
&\inner{\Phi^N}{\Psi^N} = \nonumber \\&\quad \idotsint_{\mathbb F} 
  \Phi^{N*}(\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N) \Psi^{N}(\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N) \dd^4\vc{x}_1 \cdots \dd^4\vc{x}_N,
\end{align}
where we have denoted
\begin{equation}
  \label{eq:SpinorWfn}
  \inner{\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N}{\Phi^N} \equiv \Phi^N(\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N).
\end{equation}
In this work, many--body wave functions of the form \cref{eq:SpinorWfn} will be referred to as spinor wave functions.
In particular, the utility of such as basis expansion manifests in the context of Slater determinants, such that as
a direct consequence of \cref{eq:SlaterDet,eq:MBSpinorBasis,eq:SpinorOrbital} we may express
\begin{equation}
  \label{eq:SlaterDetSpace}
  \Phi_I^N(\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N) = \frac{1}{\sqrt{N!}} \sum_{\xi \in S_N(\hilb{K}^N_I)} \Sign{\xi} \text{ } 
    \prod_{i = 1 }^N \phi_{\xi(i)}(\vc{x}_i).
\end{equation}
Unlike the tensor product definition of \cref{eq:SlaterDet}, the expression of the Slater determinant in will prove to be of 
much of practical utility due to the fact that the spinor orbital basis is commutative.

\subsection{Representation of Linear Operators and Expectation Values}
\label{sec:LO}

Fundamental to the formulation of any quantum mechanical theory is the identification of linear operators on $\hilb{H}^N$
which represent the physical observables of the system. In this work we will refer to such observables as properties. A
more precise identification of the operators relevant to this work will be presented later 
(see \cref{sec:NRH,sec:RELH,sec:SCLMI} for instance), however in this section we will focus on the general presentation
of these operators and how they will typically manifest in the context of \cref{eq:SepHilbert}. 

In this work, linear operators which act on $\hilb{H}^N$, $\op{O}^N : \hilb{H}^N \mapsto \hilb{H}^N$, will be referred to as 
$N$--particle operators. As was the case for the state vectors of $\hilb{H}^N$, the general description of $\op{O}^N$
as an operator on a Hilbert space is indeed the most illuminating treatment for general manipulations of quantum mechanical
operators which is independent of coordinate projection; however, it will often be the case that we must examine the
projection of these operators onto a coordinate space in order to perform practical calculations. To demonstrate this, we examine
the action of an operator $\op{O}^1$ on the spinor basis $\set{\ket{\vc{x}}}$ from \cref{sec:SD} through the identity resolvent in
\cref{eq:H1Identity},
\begin{align}
  \op{O}^1 = \op{1}_1 \op{O}^1 \op{1}_1 = \iint_{\mathbb F} 
    \ket{\vc{x}} \innerop{\vc{x}}{\op{O}^1}{\vc{x}'}\bra{\vc{x}'} \dd^4\vc{x} \dd^4\vc{x}',
\end{align}
such that for $\ket{\psi},\ket{\chi} \in \hilb{H}^1$,
\begin{align}
  \label{eq:SpinorOpInner1}
  \innerop{\psi}{\op{O}^1}{\chi} &= \iint_{\mathbb F}
    \psi^*(\vc{x}) \innerop{\vc{x}}{\op{O}^1}{\vc{x}'} \chi({\vc{x}'}) \dd^4\vc{x} \dd^4\vc{x}' \nonumber \\
  &= \int_{\mathbb R^3} 
    \begin{bmatrix}
      \psi^\alpha(\vc{r}) \\
      \psi^\beta(\vc{r})
    \end{bmatrix}^\dagger
    \begin{bmatrix}
      \op{O}^{1,\alpha\alpha}({\vc{r}}) & \op{O}^{1,\alpha\beta}({\vc{r}}) \\
      \op{O}^{1,\beta\alpha} ({\vc{r}}) & \op{O}^{1,\beta\beta} ({\vc{r}})
    \end{bmatrix}
    \begin{bmatrix}
      \chi^\alpha(\vc{r}) \\
      \chi^\beta(\vc{r})
    \end{bmatrix} \dd^3\vc{r},
\end{align}
where 
\begin{equation}
  \label{eq:LocalSpinorOp1}
\innerop{\vc{x}}{\op{O}^1}{\vc{x}'}  \equiv \innerop{\vc{r},\sigma}{\op{O}^1}{\vc{r}',\sigma'} = \delta^3(\vc{r} - \vc{r'}) \op{O}^{1,\sigma\sigma'}(\vc{r}').
\end{equation}
%For the remainder of this work, we will refer to the projections $\op{O}^{1,\sigma\sigma'}(\vc{r})$ as 
%spinor representations of $\op{O}^1$, or simply spinor operators. It is important to note that spinor representations
%of $N$--particle operators are still \emph{operators}, i.e. they still continue to act to the right
%to complete their operation. The utility of \cref{eq:LocalSpinorOp1} is in that it allows one to
%form operators compatible with spinor representations of the wave function as opposed to the general, 
%abstract Hilbert space definition. 
%
This notion may be generalized to $N$--particle operators in a similar manner through resolution of $\op{1}_N$,
\begin{align}
  \op{O}^N &= \op{1}_N \op{O}^N \op{1}_N 
  = \idotsint_{\mathbb F}
    \dd^4\vc{x}_1 \cdots   \dd^4\vc{x}_N
    \idotsint_{\mathbb F}
    \dd^4\vc{x}'_1 \cdots  \dd^4\vc{x}'_N \times \nonumber\\
    &\qquad\ket{\vc{x}_1,\ldots,\vc{x}_N} \innerop{\vc{x}_1,\ldots,\vc{x}_N}{\op{O}^{N}}{\vc{x}'_1,\ldots,\vc{x}'_N}\bra{\vc{x}'_1,\ldots,\vc{x}'_N} 
\end{align}
such that for arbitrary $N$--body Hartree products constructed from $\set{\ket{\psi_p}},\set{\ket{\chi_p}} \subset \hilb{H}^N$
\begin{align}
  \label{eq:SpinorOpInnerN}
  &\innerop{\psi_1,\psi_2,\ldots,\psi_N}{\op{O}^N}{\chi_1,\chi_2,\ldots,\chi_N} =  
  \sum_{\sigma_1\cdots\sigma_N}\sum_{\tau_1\cdots\tau_N} \idotsint_{\mathbb R^3} 
    \dd^3\vc{r}_1\cdots\dd^3\vc{r}_N  \nonumber \times \\ &\qquad \qquad
    \psi_1^{\sigma_1*}(\vc{r}_1) \cdots \psi_N^{\sigma_N*}(\vc{r}_N) ~ \op{O}^{N,\sigma_1\tau_1\cdots\sigma_N\tau_N}(\vc{r}_1,\ldots,\vc{r}_N) ~ 
    \chi_1^{\tau_1}(\vc{r}_1) \cdots \chi_N^{\tau_N}(\vc{r}_N),
\end{align}
where
\begin{equation}
  \label{eq:LocalSpinorOpN}
  \innerop{\vc{x}_1,\ldots,\vc{x}_N}{\op{O}^{N}}{\vc{x}'_1,\ldots,\vc{x}'_N} = 
    \left(\prod_{i=1}^N\delta^3(\vc{r}_i - \vc{r}'_i)\right) 
    \op{O}^{1,\sigma_1\sigma_1'\cdots\sigma_N\sigma_N'}(\vc{r}_1',\ldots,\vc{r}_N').
\end{equation}
For brevity, spinor representations of $N$ particle operators will 
often be interpreted as rank--2$N$ tensors in the basis of spin eigenfunctions, 
\begin{equation}
\label{eq:SpinorOpN}
\spop{O}^N (\vc{x}_1,\ldots,\vc{x}_N) \equiv \sum_{\sigma_1\cdots\sigma_N}\sum_{\sigma'_1\cdots\sigma'_N}  \op{O}^{N,\sigma_1\sigma_1'\cdots\sigma_N\sigma_N'}(\vc{r}_1,\ldots,\vc{r}_N) 
  \otimes \bigotimes_{i=1}^N \vc{e}_{\sigma_i} \otimes \vc{e}_{\sigma_i'}, 
\end{equation}
where 
\begin{align}
\vc{e}_\alpha = \begin{bmatrix} 1 \\ 0 \end{bmatrix}, \qquad \vc{e}_\beta = \begin{bmatrix} 0 \\ 1 \end{bmatrix}. 
\end{align}
The product operation of operators denoted $\spop{O}^N(\vc{x}_1,\ldots,\vc{x}_N)$ and their action onto spinor wave functions 
(or more specifically, Hartree products) will be a rank-$N$ tensor contraction over spin indices as depicted in \cref{eq:SpinorOpInner1} 
and more generally in \cref{eq:SpinorOpInnerN}. 
For the remainder of this work, we will refer to the projections $\spop{O}^N(\vc{x}_1,\ldots,\vc{x}_N)$ as 
spinor representations of $\op{O}^N$, or simply spinor operators when appropriate. It is important to note that spinor representations
of $N$--particle operators are still \emph{operators}, i.e. they still continue to act to the right
to complete their operation. The utility of \cref{eq:LocalSpinorOp1,eq:LocalSpinorOpN} is in that it allows one to
form operators compatible with spinor representations of the wave function as opposed to the general, 
abstract Hilbert space definition. 
In the following developments, it will be useful to examine \cref{eq:SpinorOpN} under a change of basis from the Kronecker products of
$\vc{e}_\alpha$ and $\vc{e}_\beta$ to that of the Pauli matrices,
\begin{equation}
  \label{eq:SpinorOpPauli}
  \spop{O}^N (\vc{x}_1,\ldots,\vc{x}_N) = \sum_{K_1\cdots K_N}\op{O}^{N,K_1\cdots K_N}(\vc{r}_1,\ldots,\vc{r}_N) \otimes \bigotimes_{i = 1}^N \pauli{K_i}
\end{equation}
where 
\begin{equation}
\label{eq:PauliMats}
\pauli{0} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}, \quad
\pauli{1} = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}, \quad
\pauli{2} = \begin{bmatrix} 0 & -\ii \\ \ii & 0 \end{bmatrix}, \quad
\pauli{3} = \begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}.
\end{equation}
An explicit derivation for the form of the general rank--$2N$ transformation is given in \cref{apx:SpinorOp}. Here we state the special case of
one particle spinor operators as it will provide the basis for many of the manipulations in subsequent developments,
\begin{subequations}
\begin{align}
&\op{O}^{1,0}(\vc{r}) = \frac{1}{2} \left( \op{O}^{1,\alpha\alpha}(\vc{r}) + \op{O}^{1,\beta\beta}(\vc{r}) \right),\\
&\op{O}^{1,1}(\vc{r}) = \frac{1}{2} \left( \op{O}^{1,\alpha\beta}(\vc{r}) + \op{O}^{1,\beta\alpha}(\vc{r}) \right),\\
&\op{O}^{1,2}(\vc{r}) = \frac{\ii}{2} \left( \op{O}^{1,\alpha\beta}(\vc{r}) - \op{O}^{1,\beta\alpha}(\vc{r}) \right),\\
&\op{O}^{1,3}(\vc{r}) = \frac{1}{2} \left( \op{O}^{1,\alpha\alpha}(\vc{r}) - \op{O}^{1,\beta\beta}(\vc{r}) \right).
\end{align}
\end{subequations}



Despite to the fact that $\hilb{H}^N$ admits a basis of a direct product space consisting of $N$ single particle
Hilbert spaces, $N$--particle operators need not carry the same structure, 
i.e. in general, these operators need not exist solely as direct products of operators on $\hilb{H}^1$. This is not to say
that $N$--particle operators \emph{cannot} adopt a product structure, just that it is not a requirement, and indeed
if often not the case. However, the notion that some $N$--particle operators \emph{can} adopt a product structure indicates the need
to describe the action of $M$--particle operators on $\hilb{H}^N$ (with $N>M$) while leaving $N-M$ particles unchanged.
To demonstrate this state of affairs, it is convenient to examine the action of such an operator, $\op{O}^M(i,j,\ldots)$, on a 
spinor wave function of the form \cref{eq:SlaterDetSpace},
\begin{align}
  \label{eq:MOpSpace}
  &\spop{O}^M(\vc{x}_i,\vc{x}_j,\ldots) \Phi_I^N(\vc{x}_1,\vc{x}_2,\ldots,\vc{x}_N) = \nonumber \\ &\qquad \quad
    \frac{1}{\sqrt{N!}} \sum_{\xi \in S_N(\hilb{K}^N_I)} \Sign{\xi} \text{ } 
    \left(\spop{O}^M(\vc{x}_i,\vc{x}_j,\ldots) \phi_{\xi(i)}(\vc{x}_i)\phi_{\xi(j)}(\vc{x}_j)\cdots\right)
    \prod_{k \neq (i,j,\ldots) }^{N-M} \phi_{\xi(k)}(\vc{x}_k),
\end{align}
where $(i,j,\ldots)$ is an $M$--element tuple specifying the subset of particles upon which it acts.
In this work, we will typically be concerned with operators which act on no more than two particles at a time.

It will be often the case in this work that $N$--particle operators may be expressed as sums over one and
two particle operators. In this context , the realization of \cref{eq:MOpSpace} is of exceptional utility in that,
for an expectation value involving a particular Slater determinant described by configuration $\mathcal{K}_I^N$
\cite{Ostlund12_book},
\begin{subequations}
  \label{eq:SlaterCondon}
\begin{align}
  &\innerop{\Phi^N_I}{\sum_i\op{O}^1(i)}{\Phi^N_I} = \sum_{i\in\hilb{K}^N_I} O^1_{ii},\\
  &\innerop{\Phi^N_I}{\sum_{i\neq j} \op{O}^2(i,j)}{\Phi^N_I} = 
    \sum_{i\neq j \in\hilb{K}^N_I} O^2_{ijij} - O^2_{ijji},
\end{align}
\end{subequations}
where for the $\hilb{H}^1$ basis $\mathcal{C} = \set{\ket{\phi_p}}$ from the previous section,
\begin{subequations}
  \label{eq:DiracInts}
\begin{align}
  &O^1_{pq} \equiv \innerop{\phi_p}{\op{O}^1(1)}{\phi_q} = 
    \int_{\mathbb F} \phi_p^*(\vc{x}_1) \spop{O}^1(\vc{x}_1) \phi_q(\vc{x}_1) \dd^4 \vc{x}_1,\\
  &O^2_{pqrs} \equiv \innerop{\phi_p, \phi_q }{\op{O}(1,2)}{\phi_r, \phi_s} = \nonumber \\ &\qquad
    \iint_{\mathbb F} 
      \phi_p^*(\vc{x}_1) \phi_q^*(\vc{x}_2) \spop{O}^2(\vc{x}_1,\vc{x}_2) 
      \phi_r(\vc{x}_1) \phi_s(\vc{x}_2) \dd^4 \vc{x}_1 \dd^4 \vc{x}_2.
\end{align}
\end{subequations}
Namely, $M$--particle on operators on $\hilb{H}^N$ may be represented as rank--$2M$ tensors on $\hilb{H}^1$; a fact which will
be used extensively in the following developments.


\co{Consolidate this section}
In the case where $\op{O}^N$ does not contain differential operators, i.e. its spatial component is scalar multiplicitive,
it will be useful to define the so called density operator, $\op{\rho}(\hilb{K}^N_I)$, for a particular configuration 
such that
\begin{equation}
\op{\rho}(\hilb{K}^N_I) = \ket{\Phi^N_I} \bra{\Phi^N_I}
\end{equation}


To demonstrate this point, we consider the spinor density operator,
\begin{equation}
  \spop{{\rho}}(\vc{r}; \vc{x}_1, \vc{x}_2, \ldots, \vc{x}_N) = \sum_i \sum_K \delta^3(\vc{r} - \vc{r}_i) \otimes \pauli{K},
\end{equation}
For a particular Slater determinant, \cref{eq:SlaterCondon,eq:DiracInts} yield
\begin{equation}
  \rho(\vc{r}) = \innerop{\Phi^N_I}{\spop{\rho}(\vc{r}; \vc{x}_1, \vc{x}_2, \ldots, \vc{x}_N)}{\Phi^N_I} = 
    \sum_K \sum_{i \in \hilb{K}_I^N} \rho_{I}^K(\vc{r}) \pauli{K}
\end{equation}

\todo{Get to this point}
In this work, we define $\rho_I^0(\vc{r})$ as the \emph{scalar density} and 
$\vc{m}_I(\vc{r}) = \set{ \rho_I^1(\vc{r}), \rho_I^2(\vc{r}), \rho_I^3(\vc{r})}$ as
the \emph{magnetization density} for configuration $I$.




\subsection{Second Quantization}
\label{sec:SQ}

While \cref{eq:SlaterDet,eq:SlaterDetSpace} provide the basic structure for the many--body fermionic wave function, its explicit form
is a bit unwieldy and thus its use for practical calculation of moieties such as expectation values more complicated than \cref{eq:SlaterCondon} 
is somewhat limited.
To this end we introduce a formalism known as second quantization, or the occupation number formalism \cite{Walecka12_book,Schuck04_book,Ostlund12_book},
which aims to greatly simplify the construction and manipulation of anti-symmetric wave functions such as those in 
\cref{eq:SlaterDet}. The primary hallmark of second quantization is in the representation of a Slater determinant
as an array of integers known as \emph{occupation numbers}, denoted $\set{n_p^I}$, indicate the inclusion (or \emph{occupation}) of elements
of $\hilb{C}$ in the configuration which describes the $I$-th determinant. As such, the length of said array is $\vert \hilb{C} \vert$
and the sum of its elements is the number of particles in the system for a representation of $\hilb{H}^N$. Due to the fact that electrons are fermions,
there is a further restriction on the possible values of the occupations numbers due to the Pauli exclusion principle,
namely that a particle can be occupied ($n^I_p=1$) or unoccupied ($n^I_p=0$), i.e. two electrons cannot occupy the same orbital. 
For the basis $\hilb{C}$ we may construct a Hilbert space, $\hilb{F}$, as a product of single particle occupations, denoted $\ket{n_p}$, such that \cite{Walecka12_book}
\begin{align}
&\ket{n_1,n_2,\ldots,n_{\vert\mathcal{C}\vert}} = \bigotimes_{i=1}^{\vert \mathcal{C} \vert} \ket{n_i}, 
  \quad \ket{n_1,n_2,\ldots,n_{\vert\mathcal{C}\vert}} \in \hilb{F},
\end{align}
where we may define inner and outer products as
\begin{subequations}
  \label{eq:OccOrthoComp}
\begin{align}
&\inner{n_1,n_2,\ldots,n_{\vert\mathcal{C}\vert}}{n'_1,n'_2,\ldots,n'_{\vert\mathcal{C}\vert}} = \prod_{i = 1}^{\vert\mathcal{C}\vert} \delta_{n_i n_i'},\\
&\sum_{n_1n_2\cdots} \ket{n_1,n_2,\ldots,n_{\vert\mathcal{C}\vert}}\bra{n_1,n_2,\ldots,n_{\vert\mathcal{C}\vert}} = \op{1}_\hilb{F}.
\end{align}
\end{subequations}
Here, $\op{1}_\hilb{F}$ is the identity operator on $\hilb{F}$. $\hilb{F}$ is commonly referred to as the Fock space.
%To avoid confusion in the subsequent developments, remark that operators on $\hilb{H}^N$ 
%\emph{do not} act on $\hilb{F}$, but rather may act indirectly through the injective map
%$\hilb{H}^N \rightarrow \hilb{F}$.

One may construct representations of Slater determinants (\cref{eq:SlaterDet}) in a consistent manner in this formalism through
the introduction of two sets of operators, $\set{ c_p^\dagger : \hilb{F} \rightarrow \hilb{F}}$ and $\set{ c_p : \hilb{F} \rightarrow \hilb{F} }$, which are referred to as creation and annihilation operators 
respectively, and the notion of a zero particle occupation vector known as the physical vacuum, $\Vac \in \hilb{F}$, such that
\begin{subequations}
  \label{eq:SeQuantAction}
\begin{align}
  &\Vac = \ket{[0_1, 0_2, \ldots, 0_{\vert C \vert}]}, \\
  &c_p^\dagger \ket{[n_1, n_2, \ldots, n_p, \ldots, n_{\vert C \vert}]} = \frac{\delta_{n_p0}}{\sqrt{N+1}} \ket{[n_1, n_2, \ldots, 1_p, \ldots, n_{\vert C \vert}]},\\
  &c_p \ket{[n_1, n_2, \ldots, n_p, \ldots, n_{\vert C \vert}]} = {\delta_{n_p1}}{\sqrt{N}} \ket{[n_1, n_2, \ldots, 0_p, \ldots, n_{\vert C \vert}]}.
\end{align}
\end{subequations}
Here, $N$ is the number of particles in the occupation vector \emph{before} action. To ensure anti-symmetry in the representation of
the wave function, we may specify the following commutation relations
\begin{subequations}
  \label{eq:SeQuantComm}
\begin{align}
  &[c_p^\dagger, c_q^\dagger]_+ = 0,\\
  &[c_p, c_q]_+ = 0,\\
  &[c_p, c_q^\dagger]_+ = \delta_{pq},
\end{align}
\end{subequations}
where $[\cdot,\cdot]_+$ is the anti--commutator. The action of products consisting on any number of these 
operators may be derived inductively from \cref{eq:SeQuantAction,eq:SeQuantComm}. Such products are often referred to as
strings. As such, we may recast \cref{eq:SlaterDet} as a string of creation operators,
\begin{equation}
  \label{eq:SeQuantSlaterDet}
  \ket{\Phi^N_I} \mapsto \ket{\Phi^N_I}_\hilb{F}  = \left(\prod_{i \in \hilb{K}^N_I} c_i^\dagger\right) \Vac,
\end{equation}
where $\ket{\Phi^N_I}_\hilb{F} \in \hilb{F}$ is the occupation vector representation of $\ket{\Phi^N_I}$.


\todo{Wicks thm (mention)}
\todo{Thouless thm}

Perhaps the most remarkable result of second quantization for many--body quantum theory, at least in the 
context of practical utility, is in the representation of $M$--particle operators on $\hilb{H}^N$ as 
scalar contractions of $2M$--element operator strings with rank--$2M$ tensors on $\hilb{H}^1$,
\begin{subequations}
\begin{align}
  &\sum_i \op{O}^1(i) \mapsto \op{O}_\hilb{F}^1 = \sum_{pq}   O^1_{pq} c^\dagger_p c_q,\\
  &\sum_{i\neq j}\op{O}^2(i,j) \mapsto \op{O}_\hilb{F}^2 = \sum_{pqrs} O^2_{qprs} c^\dagger _p c^\dagger _q c_r c_s.
\end{align}
\end{subequations}
The tensors $O^1_{pq}$ and $O^2_{qprs}$ are defined as in \cref{eq:DiracInts}.

\begin{equation}
  \ket{\Phi^N_I} = t^I_0\ket{0} + \sum_{ai} t^I_{ai} \ket{0}_i^a + \sum_{abij} t^I_{abij} \ket{0}_{ij}^{ab} + \sum_{abcijk} t^I_{abcijk} \ket{0}_{ijk}^{abc} + \cdots
\end{equation}

\co{Note: no dependence on choice of single particle basis, depends solely on definition of inner product and evaluation of SQ strings}





% Non--Relativistic Hamiltonian
\subsection{Non--Relativistic Molecular Hamiltonians: The Schr\"{o}dinger Equation}
\label{sec:NRH}

Fundamental to the description of any quantum molecular system, relativistic or non--relativistic, is the non--relativistic
molecular Hamiltonian, $\op{H}^\NR : \hilb{H}^\NR \mapsto \hilb{H}^\NR$, where $\hilb{H}^\NR$ describes a quantum
system containing $N_\mathrm{el}$ electrons and $N_\mathrm{nuc}$ nuclei. $\op{H}^\NR$ is so fundamental to the description
of quantum molecular systems in that it is the linear operator on $\hilb{H}^\NR$ which represents the non--relativistic 
total energy of the system.  In the absence of external fields, $\op{H}^\NR$ takes the form
\begin{equation}
  \label{eq:FullHNR}
  \op{H}^\NR = \op{H}_{el}^\NR + \op{H}_{nuc}^\NR + \op{H}_{mix}^\NR
\end{equation}
where 
\begin{subequations}
\begin{align}
  &\op{H}_{el}^\NR  = \sum_i^{N_\mathrm{el}}\op{T}^\NR(i) + \frac{1}{2}\sum_{i \neq j}^{N_\mathrm{el}} \op{g}^C(i,j),\\ 
  &\op{H}_{nuc}^\NR = \sum_A^{N_\mathrm{nuc}}\op{T}^\NR(A) + \frac{1}{2}\sum_{A \neq B}^{N_\mathrm{nuc}} \op{g}^C(A,B),\\ 
  &\op{H}^\NR_{mix} = -\sum_i^{N_\mathrm{el}} \sum_A^{N_\mathrm{nuc}} \op{g}^C(i,A).
\end{align}
\end{subequations}
Here we have denoted operator action onto the electronic degrees of freedom as $i,j$ and $A,B$ for the nuclear degrees of
freedom. For a general (electronic or nuclear) coordinate, $\xi$, the non--relativistic kinetic energy operator, 
$\op{T}^\NR$, is given by
\begin{align}
  \op{T}^\NR(\xi) = \frac{1}{2m_\xi} \op{\vc{p}}(\xi) \cdot \op{\vc{p}}(\xi),
\end{align}
where $\op{\vc{p}}$ is the linear momentum operator and $m_\xi$ is the mass of the $\xi$-th particle.
$\op{g}^C$ is the two body Coulomb operator which describes the electrostatic interaction between charged particles.

In the spinor representation, these operators take the general form (in atomic units)
\begin{align}
  \label{eq:SpinorKinMom}
  &\spop{\vc{p}}(\vc{x}_\xi) = -\ii \nabla_\xi \otimes \op{I}_S(\xi) \quad \Longrightarrow \quad 
  \spop{T}^\NR(\vc{x}_\xi) = - \frac{1}{2m_\xi} \Delta_\xi \otimes \op{I}_S(\xi),
\end{align}
\begin{align}
  \label{eq:SpinorCoulomb}
  &\spop{g}^C(\vc{x}_\xi,\vc{x}_\zeta) = 
    \frac{1}{\vert \vc{r}_\xi - \vc{r}_\zeta \vert} \otimes \op{I}_S(\xi) \otimes \op{I}_S(\zeta),
\end{align}
where $\nabla_\xi$ and $\Delta_\xi$ are the gradient and Laplacian operators acting on the $\xi$-th spatial coordinate,
repsectively. $\op{I}_S(\xi)$  is the identity spin operator for particle $\xi$, which has been introduced to make a
careful distinction between the spinor basis of electrons, which are spin--1/2 fermions, and nuclei, which are in general
\emph{not} spin--1/2 fermions and thus carry a much more complicated spin structure \todo{cite}. For electrons, $\op{I}_S=\pauli{0}$.
The presence of $\op{I}_S$ in \cref{eq:SpinorKinMom,eq:SpinorCoulomb} may be interpreted as the action of these operators 
\emph{do not} manipulate the spin degrees of freedom of the total wave function.

As has been previously stated on numerous occasions, the primary focus of this work is to treat the many body
electronic problem for molecular systems, not the quantum nature of the nuclei. The combined quantum treatment
of \cref{eq:FullHNR} obfuscates this point in that the presence of $\op{H}^\NR_{mix}$ intimately couples the
electronic and nuclear degrees of freedom. Thus it would be of practical utility to, in some way, decouple
the quantum treatment of the electrons and the nuclei such that they may be treated separately. 
%To this end,
%we will work within the Born--Oppenheimer approximation \todo{cite} for the molecular Hamiltonian such that
%we will consider a single tensor product ansatz for the total molecular wave function $\ket{\Psi_{tot}}$,
To this end, we will work within the Born--Oppenheimer ansatz for the molecular wave function \todo{cite} such
that it may be written as a single tensor product of an electronic and nuclear wave function,
\begin{equation}
  \ket{\Psi_{tot}} \approx \ket{\Psi_{el}} \otimes \ket{\Theta_{nuc}}.
\end{equation}
Due to a large disperigy in mass between electrons and nuclei, the energic regimes which describe their respective
dynamics are typically well separated. As such, we will be operating under the assumption that the energic
contributions arising from nuclear motion, i.e. the nuclear kinetic energy, may be safely ignored in our
treatment of the electronic degrees of freedom,
\begin{equation}
\innerop{\Psi_{tot}}{\sum_A^{N_\mathrm{nuc}} \op{T}^\NR(A) }{\Psi_{tot}} \approx 0.
\end{equation}
This assumption is referred to as the Born--Oppenheimer approximation (a concept distict from from the 
Born--Oppenheimer ansatz for the molecular wave function). One should remark that this approximation
only makes sense from the inertial frame of the electrons, i.e. from the electrons' perspective, they
only feel a scalar potential of a fixed nuclear configuration due to a large disperigy in relative 
velocities between themselves and the nuclei. The nuclei are still permitted to move within this approximation;
the primary assumption being that such dynamics occurs an a time scale which allows for approximately 
instantaneous response of the electronic degrees of freedom from the inertial frame of the nuclei.
Within this approximation, we may separate the wave equation of \cref{eq:QWave} into two coupled
non--linear differential equations, such that for a particular time $t$
\begin{align}
&\op{H}^\BO_{el}(t) \ket{\Psi_{el}(t)} = \ii \partial_t \ket{\Psi_{el}(t)},\\
&\op{H}^\BO_{nuc}(t) \ket{\Theta_{nuc}(t)} = \ii \partial_t \ket{\Theta_{nuc}(t)},
\end{align}
where
\begin{align}
&\op{H}^\BO_{el}(t)  %&= \innerop{\Theta_{nuc}(t)}{\op{H}^\NR - \sum_A^{N_\mathrm{nuc}} \op{T}^\NR(A)}{\Theta_{nuc}(t)} \nonumber\\
  = E_{nn}(t) + \sum_i^{N_\mathrm{el}} \op{T}^\NR(i) + \op{V}_{ne}(t;i) + \sum_{i\neq j}^{N_\mathrm{el}} \op{g}^C(i,j)\\
&\op{H}^\BO_{nuc}(t) = \sum_A^{N_\mathrm{nuc}} \op{T}^\NR(A) + E_{el}(t)\\
&E_{el}(t) = \innerop{\Psi_{el}(t)}{\op{H}^\BO_{el}(t)}{\Psi_{el}(t)}
\end{align}


\begin{align}
  &\op{V}_{ne}(\vc{x}_i) = \left(\int_{\mathbb R^3} \frac{\rho^0_\mathrm{nuc}(\vc{R})}{\vert \vc{r}_i - \vc{R} \vert} \dd^3\vc{R}\right) \otimes \pauli{0} \\
&E_{nn} = \iint_{\mathbb R^3} \frac{\rho^0_\mathrm{nuc}(\vc{R})\rho^0_\mathrm{nuc}(\vc{R}')}{\vert \vc{R} - \vc{R}' \vert} \dd^3\vc{R} \dd^3\vc{R}'
\end{align}




% Relativistic Hamiltonian
\subsection{Approximate Relativistic Hamiltonians: The Dirac Equations and Two--Component Variants}
\label{sec:RELH}

\todo{Dirac Hamiltonian + why it fixes things}
\todo{DCB Hamiltoninan}
\todo{BP hamiltonian from DCB}
\todo{NR limit of BP}
\todo{General Two component}
\todo{X2C (why its better), possibly appendix on implementation?}
\todo{Uncontracted basis?}








\subsection{Mean--Field Quantum Mechanics and Density Functional Theory}
\label{sec:MF}


% Semi--Classical Light Matter
\section{Semi--Classical Light--Matter Interaction}
\label{sec:SCLMI}

% Polarization Propagator
\subsection{The Resonant Convergent Polarization Propagator}
\label{sec:PolarProp}

% Absorption Cross Section
\subsection{The Linear Absorption Cross Section}
\label{sec:AbsorptionTheory}
